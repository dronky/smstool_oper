/* REXX */
/* PROCEDURE WHICH USES DSKLST FOR FIND FREE FREE ADDRESS */
CALL ISPPRXVP 'I'
ADDR = 'NOT FOUND'
IF ISFCALLS('ON') <> 0 THEN EXIT 99
"ALLOC DA('"DSKLST"') F(INPUTDD) SHR REUSE"
"EXECIO * DISKR INPUTDD (STEM DSKL. FINIS"
"FREE F(INPUTDD)"
/* SPLITTING STRINGS TO ADDR */
TMPVOL=''
DO I=2 TO DSKL.0 WHILE TMPVOL/='******'
  TMPVOL = SUBSTR(DSKL.I,10,6)
  IF LEFT(TMPVOL,2) = 'TM' THEN DO
    TMPSIZE = SUBSTR(DSKL.I,19,2)
    IF SIZE = TMPSIZE THEN DO
      ADDR = SUBSTR(DSKL.I,1,4)
      DSKL.I=ADDR'     'VOL'   'TMPSIZE
      LEAVE
    END
  END
END
"ALLOC DA('"DSKLST"') F(OUTDD) SHR REUSE"
"EXECIO * DISKW OUTDD (STEM DSKL. FINIS"
"FREE F(OUTDD)"
CALL ISFCALLS 'OFF'
CALL ISPPRXVP 'T'
EXIT 0
